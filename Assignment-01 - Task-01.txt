CREATE DATABASE NIKIT_ASSIGNMENT_01;

USE NIKIT_ASSIGNMENT_01;

CREATE OR REPLACE TABLE NP_SHOPPING_HISTORY(
PRODUCT VARCHAR NOT NULL,
QUANTITY INT NOT NULL,
UNIT_PRICE INT NOT NULL);

INSERT INTO "NP_SHOPPING_HISTORY" VALUES 
('MILK', 3, 10),
('BREAD', 7, 3),
('BREAD', 5, 2),
('TOAST', 5, 10),
('MILK', 4, 10),
('TOAST', 5, 8),
('CUSTARD', 2, 5),
('BUTTER', 5, 4),
('CUSTARD', 6, 5),
('BUTTER', 7, 4);

SELECT * FROM "NP_SHOPPING_HISTORY";

SELECT PRODUCT, QUANTITY * UNIT_PRICE AS TOTAL_PRICE FROM "NP_SHOPPING_HISTORY";


SELECT PRODUCT, SUM(TOTAL_PRICE) AS TOTAL_PRICE FROM 
(SELECT PRODUCT, QUANTITY * UNIT_PRICE AS TOTAL_PRICE FROM "NP_SHOPPING_HISTORY") GROUP BY PRODUCT;
